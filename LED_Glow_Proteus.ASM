ORG 00H


bluetooth:   
MOV TMOD,#20H 	;TIMER 1 MODE 2   8 BIT MODE
MOV TH1,#-3 	;9600 BAUD RATE
MOV SCON,#50H	;SERIAL MODE 1; 10 BIT TOTAL [1 START BIT + 8 DATA BIT + 1 STOP BIT]]
CLR TI		; MAKE TI REGISTER ZERO
CLR RI		; MAKE RI REGISTER ZERO
SETB TR1	; START TIMER-1

MOV P1,#000H

AGAIN: 
REPEAT: JNB RI,REPEAT
	MOV A,SBUF	; MOVE CONTENT OF SBUF TO ACCUMULATOR
	CJNE A,#'a',CHECKNEXT1
	CPL P1.0
	CLR RI
	CLR TI
	LJMP AGAIN
	
CHECKNEXT1:
	CJNE A,#'b',CHECKNEXT2
	CPL P1.1
	CLR RI
	CLR TI
	LJMP AGAIN
	
CHECKNEXT2:
	CJNE A,#'c',CHECKNEXT3
	CPL P1.2
	CLR RI
	CLR TI
	LJMP AGAIN
		
CHECKNEXT3:
	CJNE A,#'d',CHECKNEXT4
	CPL P1.3
	CLR RI
	CLR TI
	LJMP AGAIN

CHECKNEXT4:
	CJNE A,#'e',CHECKNEXT5
	CPL P1.4
	CLR RI
	CLR TI
	LJMP AGAIN

CHECKNEXT5:
	CJNE A,#'f',CHECKNEXT6
	CPL P1.5
	CLR RI
	CLR TI
	LJMP AGAIN

CHECKNEXT6:
	CJNE A,#'g',CHECKNEXT7
	CPL P1.6
	CLR RI
	CLR TI
	LJMP AGAIN
         
CHECKNEXT7:
	CJNE A,#'h',CHECKNEXT8
	CPL P1.7
	CLR RI
	CLR TI
	LJMP AGAIN
	
CHECKNEXT8:
	CJNE A,#'i',CHECKNEXT9
	
	MOV P0,#0FFFFH	;connected to DOT_MATRIX DISPLAY
	MOV P2,#0FFFFH	;connected to DOT_MATRIX DISPLAY
	
	MOV R5,#00000000B
	MOV R6,#11111111B
	MOV 50H,#20D		;COUNTER FOR BLINKING 20 TIMES
	DOT_MATRIX:  LCALL DOT_MATRIX_BLINK
	DJNZ 50H,DOT_MATRIX
	CLR RI
	CLR TI
	LJMP AGAIN

CHECKNEXT9:
	CJNE A,#'j',GO_BACK
	;RESET ALL
	MOV P1,#00H
	CLR RI
	CLR TI
	LJMP bluetooth
	
GO_BACK: LJMP AGAIN

DOT_MATRIX_BLINK:
;GLOW
CLR P0.0
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.0
MOV P2,R5
ACALL DELAY1

;GLOW
CLR P0.1
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.1
MOV P2,R5
ACALL DELAY1

;GLOW
CLR P0.2
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.2
MOV P2,R5
ACALL DELAY1


;GLOW
CLR P0.3
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.3
MOV P2,R5
ACALL DELAY1


;GLOW
CLR P0.4
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.4
MOV P2,R5
ACALL DELAY1


;GLOW
CLR P0.5
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.5
MOV P2,R5
ACALL DELAY1

;GLOW
CLR P0.6
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.6
MOV P2,R5
ACALL DELAY1


;GLOW
CLR P0.7
MOV P2,R6
ACALL DELAY1

;DIM
SETB P0.7
MOV P2,R5
ACALL DELAY1

RET


	
DELAY:   MOV  R3,#50
AGAIN_2: MOV  R4,#255
AGAIN_3:   DJNZ R4,AGAIN_3
         DJNZ R3,AGAIN_2
         RET

DELAY1:
		MOV R0,#3
	L1:	MOV R1,#100
	L2:	MOV R2,#100
	L3:	DJNZ R2,L3
		DJNZ R1,L2
		DJNZ R0,L1
		RET
		
	END